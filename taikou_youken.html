<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>宅建 権利関係クイズ - 対抗要件</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background-color: #f8f9fa;
    }
    #root {
      max-width: 400px;
      margin: 0 auto;
      min-height: 100vh;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect } = React;

    const QuizApp = () => {
      const [page, setPage] = useState('about');
      const [currentQuiz, setCurrentQuiz] = useState(0);
      const [score, setScore] = useState(0);
      const [answered, setAnswered] = useState(false);
      const [selectedAnswer, setSelectedAnswer] = useState(null);
      const [quizStarted, setQuizStarted] = useState(false);
      const [quizFinished, setQuizFinished] = useState(false);
      const [shuffledQuizzes, setShuffledQuizzes] = useState([]);
      const [level, setLevel] = useState(null);
      const [answeredQuestions, setAnsweredQuestions] = useState([]);
      const [masteredQuestions, setMasteredQuestions] = useState(new Set());
      const [reviewMode, setReviewMode] = useState('all');

      useEffect(() => {
        const saved = localStorage.getItem('takken_taikou_mastered');
        if (saved) {
          setMasteredQuestions(new Set(JSON.parse(saved)));
        }
      }, []);

      const quizzesLevel1 = [
        {
          question: "AさんがBさんに土地を売った。その後、AさんがCさんにも同じ土地を売った（二重譲渡）。BさんもCさんも登記していない場合、BさんはCさんに対して所有権を主張できる。",
          answer: false,
          explanation: "登記がない場合、BもCも互いに対抗できない。この状態では権利関係が確定しない。先に登記した方が勝つ。",
          category: "二重譲渡"
        },
        {
          question: "AさんがBさんに土地を売った。その後、AさんがCさんにも同じ土地を売った。Bさんが先に登記した。Cさんは土地を取得できる。",
          answer: false,
          explanation: "Bさんが先に登記したので、Bさんの勝ち。登記の早い者勝ち（177条）。",
          category: "二重譲渡"
        },
        {
          question: "AさんがBさんに土地を売った。その後、AさんがCさんにも同じ土地を売った。Cさんが先に登記した。Cさんが悪意（Bへの売却を知っていた）でも、Cさんは土地を取得できる。",
          answer: true,
          explanation: "177条の対抗問題では、善意悪意は関係ない。登記の早い者勝ち。悪意でも登記があれば勝つ。",
          category: "二重譲渡"
        },
        {
          question: "Aさんが20年間、他人の土地を占有して取得時効が完成した。時効完成前に、元の所有者BさんがCさんに土地を売却し、Cさんが登記した。Aさんは登記なしでCさんに対抗できる。",
          answer: true,
          explanation: "時効完成「前」の第三者Cは、時効完成時の所有者であり「当事者」扱い。したがって、Aは登記なしでCに対抗できる（最判昭和41年11月22日）。",
          category: "時効・前"
        },
        {
          question: "Aさんが20年間、他人の土地を占有して取得時効が完成した。時効完成後に、元の所有者BさんがCさんに土地を売却し、Cさんが登記した。Aさんは登記なしでCさんに対抗できる。",
          answer: false,
          explanation: "時効完成「後」の第三者には、登記がないと対抗できない（177条）。時効完成前でも後でも、完成「後」の第三者には登記が必要。",
          category: "時効・後"
        },
        {
          question: "AさんがBさんに土地を売った。Bさんは登記していない。その後、Aさんの債権者がこの土地を差し押さえた。Bさんは登記なしで債権者に対抗できる。",
          answer: false,
          explanation: "差し押さえ債権者も「第三者」に含まれる。登記がないと対抗できない。",
          category: "第三者の範囲"
        },
        {
          question: "AさんがBさんに土地を売った。Bさんは登記していない。その後、Aさんが亡くなり、Cさんが相続した。Bさんは登記なしでCさん（相続人）に対抗できる。",
          answer: true,
          explanation: "相続人は「第三者」ではない。Aの地位を引き継ぐだけなので、Bは登記なしで対抗できる。",
          category: "第三者の範囲"
        },
        {
          question: "AさんがBさんに土地を売った。Bさんは登記していない。その後、Cさんが不法にこの土地を占拠した。Bさんは登記なしでCさん（不法占拠者）に対抗できる。",
          answer: true,
          explanation: "不法占拠者は「第三者」ではない（正当な権利がない）。Bは登記なしで対抗できる。",
          category: "第三者の範囲"
        },
        {
          question: "AさんがBさんに土地を売った。Bさんが登記する前に、AさんがDさんに同じ土地を売り、Dさんが登記した。その後、DさんがEさんに転売。Bさんは登記なしでEさんに対抗できる。",
          answer: false,
          explanation: "Eさんは「第三者」。たとえDから買ったとしても、Bは登記がないと対抗できない。",
          category: "転得者"
        },
        {
          question: "二重譲渡で、先に買ったBさんは登記せず、後から買ったCさんが登記した。Cさんが背信的悪意者（Bの存在を知っていて、わざと横取りした）の場合、Cさんは保護される。",
          answer: false,
          explanation: "背信的悪意者は、登記があっても保護されない。あまりに悪質だから。",
          category: "背信的悪意者"
        },
        {
          question: "登記には「対抗力」があるが、「権利を創設する力」はない。",
          answer: true,
          explanation: "正しい。登記は「私が権利者だ」と主張するためのもの（対抗力）。登記しても権利は生まれない。",
          category: "登記の効力"
        },
        {
          question: "AがBに土地を売却し、BがCに転売した。BもCも登記していない状態で、Aが「この土地はまだ自分のものだ」とCに主張した場合、Cは登記がなくてもAの主張を退けることができる。",
          answer: true,
          explanation: "転々譲渡（A→B→C）の場合、前主Aと後主Cは当事者関係にある。したがって、Cは登記なしでAに対抗できる。Aは「第三者」ではないため、Cに登記は不要。",
          category: "転得者"
        },
        {
          question: "177条の「第三者」には、不法行為者や不法占拠者は含まれない。",
          answer: true,
          explanation: "正しい。正当な権利関係のない者は「第三者」ではない。",
          category: "第三者の範囲"
        },
        {
          question: "二重譲渡において、後から買ったCさんが先に登記すれば、Cさんが悪意であっても土地を取得できる。",
          answer: true,
          explanation: "正しい。177条の対抗問題では善意悪意は問わない。登記の早い者勝ち（ただし背信的悪意者を除く）。",
          category: "二重譲渡"
        },
        {
          question: "取得時効完成前の第三者に対しては、時効取得者は登記なしで対抗できる。",
          answer: true,
          explanation: "時効完成「前」の第三者Cは、時効完成時の所有者であり「当事者」扱い。したがって、時効取得者Aは登記なしでCに対抗できる（最判昭和41年11月22日）。",
          category: "時効・前"
        }
      ];

      const quizzesLevel2 = [
        {
          question: "Aを所有者とする甲土地につき、AとBとの間で売買契約が締結された。Aが甲土地をBに売却した後、AがCに対しても甲土地を売却し、Cが移転登記を備えた場合、BがAとの売買契約に基づく所有権移転登記を備えていなかったとしても、Bがその売買契約に基づいてすでに甲土地の引渡しを受けていたときは、Bは所有権をCに対抗することができる。",
          answer: false,
          explanation: "二重譲渡では、引渡しだけでは対抗できない。不動産は登記が対抗要件（177条）。先に登記したCが勝つ。",
          category: "二重譲渡"
        },
        {
          question: "Aを所有者とする甲土地につき、AとBとの間で売買契約が締結された。AがBに甲土地を売却した後、Aの債権者Cが甲土地を差し押さえた場合、Bが所有権移転登記を備えていなくても、売買契約の日がCによる差押えの日より前であれば、BはCに対して所有権を対抗することができる。",
          answer: false,
          explanation: "差押債権者も177条の「第三者」に含まれる。登記がなければ対抗できない。契約の先後は関係ない。",
          category: "第三者の範囲"
        },
        {
          question: "Aを所有者とする甲土地につき、AとBとの間で売買契約が締結された。AがBに甲土地を売却した後、Aが死亡し、Cが単独で相続した場合、Bが所有権移転登記を備えていなくても、BはCに対して所有権の取得を対抗することができる。",
          answer: true,
          explanation: "相続人は177条の「第三者」ではない。被相続人の地位を承継するだけなので、Bは登記なしで対抗できる。",
          category: "第三者の範囲"
        },
        {
          question: "Aを所有者とする甲土地につき、AとBとの間で売買契約が締結された。AがBに甲土地を売却した後、Dが甲土地を不法占拠した場合、Bが所有権移転登記を備えていなくても、BはDに対して所有権に基づく明渡しを請求することができる。",
          answer: true,
          explanation: "不法占拠者は177条の「第三者」ではない。正当な権利関係がないので、Bは登記なしで明渡請求できる。",
          category: "第三者の範囲"
        },
        {
          question: "Aは、Bから購入した甲土地をCに売却してその旨の所有権移転登記をした。その後、AB間の売買契約が、Bの意思無能力を理由に無効とされた場合、Aは、Cの所有権移転登記の抹消をCに請求することができない。",
          answer: false,
          explanation: "AB間が無効なら、Aは最初から所有権を取得していない。したがって、Cへの移転も無効。Aは登記の抹消を請求できる（Cは「第三者」ではあるが、Aが無権利者なので）。",
          category: "無効と第三者"
        },
        {
          question: "AはBに甲土地を売却したが、その後Bの債務不履行により売買契約を解除した。解除前にBが甲土地をCに転売し、Cが所有権移転登記を備えた場合、AはCに対して所有権を主張することができない。",
          answer: true,
          explanation: "解除前の第三者Cは、登記を備えていれば保護される（545条1項ただし書）。",
          category: "解除と第三者"
        },
        {
          question: "AがBから購入した甲土地について、Aが所有権移転登記を備えた。その後、AB間の売買契約がBの強迫を理由に取り消された。取消し後、Bが甲土地をCに売却し、Cが所有権移転登記を備えた場合、Aが登記を回復していなくても、AはCに対して所有権を主張することができる。",
          answer: false,
          explanation: "取消し後の第三者との関係は177条の対抗問題。先に登記を備えたCが勝つ。",
          category: "取消しと第三者"
        },
        {
          question: "Aは、その所有する甲土地を、Bとの間の売買契約により、Bに売却した。Bが所有権移転登記を備えないうちに、Aが死亡し、Cが単独で相続した場合、CはBに対して、自らが所有者であると主張して、所有権移転登記をCに移すことを請求することができない。",
          answer: true,
          explanation: "相続人Cは「第三者」ではなく、Aの地位を承継するだけ。したがって、Bへの売却義務も承継するので、Bに登記を移すよう請求することはできない。",
          category: "第三者の範囲"
        },
        {
          question: "Aが20年間所有の意思をもって平穏かつ公然にB所有の土地を占有し、取得時効が完成した。時効完成後、BがCに当該土地を売却し、Cが所有権移転登記を備えた場合、Aは登記がなければCに対して所有権を主張することができない。",
          answer: true,
          explanation: "取得時効完成後の第三者との関係は177条の対抗問題。登記がなければ対抗できない。",
          category: "時効・後"
        },
        {
          question: "Aが20年間所有の意思をもって平穏かつ公然にB所有の土地を占有していた。取得時効完成前に、BがCに当該土地を売却し、Cが所有権移転登記を備えた場合、その後Aの取得時効が完成しても、Aは登記がなければCに対して所有権を主張することができない。",
          answer: false,
          explanation: "時効完成「前」の第三者Cは、時効完成時の所有者であり「当事者」扱い。したがって、Aは登記なしでCに対抗できる（最判昭和41年11月22日）。",
          category: "時効・前"
        },
        {
          question: "AはBに甲土地を売却した。Bが登記を備える前に、AがCにも甲土地を売却し、Cが登記を備えた。BはAとの売買契約が先であることを理由に、Cに対して所有権を主張することができる。",
          answer: false,
          explanation: "二重譲渡では契約の先後は関係ない。登記の先後で決まる（177条）。先に登記したCが勝つ。",
          category: "二重譲渡"
        },
        {
          question: "AはBに甲土地を売却した。Bが登記を備える前に、AがCにも甲土地を売却し、Cが登記を備えた。Cが、Bの存在を知りながら、Bよりも先に登記を得る目的でAから購入した場合（背信的悪意者）でも、Cは所有権を取得する。",
          answer: false,
          explanation: "背信的悪意者は、登記があっても保護されない。判例により、このような者は「第三者」に当たらないとされる。",
          category: "背信的悪意者"
        },
        {
          question: "Aは、その所有する甲土地をBに売却し、所有権移転登記をBに移転した。その後、AB間の売買契約が詐欺を理由に取り消され、Aが登記を回復する前に、Bが甲土地をCに売却し、Cが所有権移転登記を備えた。この場合、CがBの詐欺について悪意であっても、AはCに対して所有権を主張することができない。",
          answer: true,
          explanation: "取消し後の第三者との関係は177条の対抗問題。悪意であっても、先に登記を備えたCが勝つ。",
          category: "取消しと第三者"
        },
        {
          question: "Aは、その所有する甲土地をBに売却した。Bが登記を備える前に、Cが甲土地を不法に占拠した場合、Bは登記がなくても、Cに対して所有権に基づく返還請求をすることができる。",
          answer: true,
          explanation: "不法占拠者は「第三者」ではない。Bは登記なしで返還請求できる。",
          category: "第三者の範囲"
        },
        {
          question: "AがBに甲土地を売却し、その後AがCにも甲土地を売却した。BとCがいずれも登記を備えていない場合、BはCに対して所有権を主張することができない。",
          answer: true,
          explanation: "BもCも登記がない場合、互いに対抗できない。この状態では権利関係が確定しない（どちらが先に登記するかによる）。",
          category: "二重譲渡"
        }
      ];

      const shuffleArray = (array) => {
        const shuffled = [...array];
        for (let i = shuffled.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
        }
        return shuffled;
      };

      const startQuiz = (selectedLevel, mode = 'all') => {
        setLevel(selectedLevel);
        setReviewMode(mode);
        const quizzes = selectedLevel === 1 ? quizzesLevel1 : quizzesLevel2;
        
        let filteredQuizzes = quizzes;
        if (mode === 'unmastered') {
          filteredQuizzes = quizzes.filter((_, idx) => !masteredQuestions.has(`${selectedLevel}-${idx}`));
        }
        
        if (filteredQuizzes.length === 0) {
          alert('未習得の問題がありません！全問題モードで開始します。');
          filteredQuizzes = quizzes;
        }
        
        setShuffledQuizzes(shuffleArray(filteredQuizzes));
        setQuizStarted(true);
        setQuizFinished(false);
        setCurrentQuiz(0);
        setScore(0);
        setAnswered(false);
        setSelectedAnswer(null);
        setAnsweredQuestions([]);
      };

      const handleAnswer = (answer) => {
        if (answered) return;
        setSelectedAnswer(answer);
        setAnswered(true);
        const isCorrect = answer === shuffledQuizzes[currentQuiz].answer;
        if (isCorrect) {
          setScore(score + 1);
        }
        setAnsweredQuestions([...answeredQuestions, { index: currentQuiz, correct: isCorrect }]);
      };

      const markAsMastered = () => {
        const quizzes = level === 1 ? quizzesLevel1 : quizzesLevel2;
        const currentQuizData = shuffledQuizzes[currentQuiz];
        const originalIndex = quizzes.indexOf(currentQuizData);
        const key = `${level}-${originalIndex}`;
        
        const newMastered = new Set(masteredQuestions);
        newMastered.add(key);
        setMasteredQuestions(newMastered);
        localStorage.setItem('takken_taikou_mastered', JSON.stringify([...newMastered]));
        
        nextQuiz();
      };

      const nextQuiz = () => {
        if (currentQuiz + 1 >= shuffledQuizzes.length) {
          setQuizFinished(true);
        } else {
          setCurrentQuiz(currentQuiz + 1);
          setAnswered(false);
          setSelectedAnswer(null);
        }
      };

      const prevQuiz = () => {
        if (currentQuiz > 0) {
          setCurrentQuiz(currentQuiz - 1);
          const prevAnswered = answeredQuestions.find(a => a.index === currentQuiz - 1);
          if (prevAnswered) {
            setAnswered(true);
            setSelectedAnswer(prevAnswered.correct ? shuffledQuizzes[currentQuiz - 1].answer : !shuffledQuizzes[currentQuiz - 1].answer);
          } else {
            setAnswered(false);
            setSelectedAnswer(null);
          }
        }
      };

      const resetQuiz = () => {
        setQuizStarted(false);
        setLevel(null);
      };

      const PersonCircle = ({ label, role, color }) => (
        <div style={{ textAlign: 'center' }}>
          <div style={{ 
            fontSize: '10px', 
            color: '#2c3e50', 
            marginBottom: '2px',
            fontWeight: 'bold',
            backgroundColor: '#ecf0f1',
            padding: '2px 6px',
            borderRadius: '4px'
          }}>
            {role}
          </div>
          <div style={{
            width: '40px',
            height: '40px',
            borderRadius: '50%',
            backgroundColor: color,
            color: 'white',
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
            fontSize: '20px',
            fontWeight: 'bold',
            margin: '0 auto'
          }}>{label}</div>
        </div>
      );

      const renderAbout = () => (
        <div style={{ padding: '16px' }}>
          <div style={{
            backgroundColor: 'white',
            borderRadius: '12px',
            padding: '16px',
            marginBottom: '16px',
            boxShadow: '0 2px 8px rgba(0,0,0,0.1)'
          }}>
            <div style={{
              fontSize: '16px',
              fontWeight: 'bold',
              color: '#2c3e50',
              marginBottom: '16px',
              paddingBottom: '8px',
              borderBottom: '2px solid #3498db'
            }}>
              🎯 このアプリの目的
            </div>
            
            <div style={{
              fontSize: '18px',
              fontWeight: 'bold',
              color: '#e74c3c',
              marginBottom: '16px',
              textAlign: 'center',
              padding: '12px',
              backgroundColor: '#ffebee',
              borderRadius: '8px'
            }}>
              過去問が解けるようになること
            </div>

            <div style={{
              fontSize: '16px',
              fontWeight: 'bold',
              color: '#2c3e50',
              marginBottom: '12px',
              marginTop: '24px'
            }}>
              📚 合格までの流れ
            </div>

            <div style={{
              backgroundColor: '#e3f2fd',
              padding: '12px',
              borderRadius: '8px',
              marginBottom: '12px',
              fontSize: '13px',
              lineHeight: 1.8
            }}>
              <div style={{ fontWeight: 'bold', color: '#1976d2', marginBottom: '4px' }}>
                【今ここ】このアプリで基礎固め
              </div>
              <div style={{ marginLeft: '8px' }}>
                ↓<br/>
                原理とパターンを理解する<br/>
                過去問を解く準備ができる
              </div>
            </div>

            <div style={{
              backgroundColor: '#fff3e0',
              padding: '12px',
              borderRadius: '8px',
              marginBottom: '12px',
              fontSize: '13px',
              lineHeight: 1.8,
              border: '2px solid #ff9800'
            }}>
              <div style={{ fontWeight: 'bold', color: '#e65100', marginBottom: '4px' }}>
                【次にやること】過去問を回す ★重要★
              </div>
              <div style={{ marginLeft: '8px' }}>
                ↓<br/>
                12年分を何周も繰り返す<br/>
                間違えた問題を潰していく<br/>
                <strong>→ ここが合格のカギ！</strong>
              </div>
            </div>

            <div style={{
              backgroundColor: '#f3e5f5',
              padding: '12px',
              borderRadius: '8px',
              marginBottom: '16px',
              fontSize: '13px',
              lineHeight: 1.8
            }}>
              <div style={{ fontWeight: 'bold', color: '#7b1fa2', marginBottom: '4px' }}>
                【仕上げ】細かい知識を補充
              </div>
              <div style={{ marginLeft: '8px' }}>
                ↓<br/>
                教科書で確認<br/>
                → 合格！
              </div>
            </div>

            <div style={{
              backgroundColor: '#fff9c4',
              border: '2px solid #fbc02d',
              borderRadius: '8px',
              padding: '12px',
              fontSize: '13px',
              lineHeight: 1.8,
              color: '#f57f17',
              marginBottom: '16px'
            }}>
              <div style={{ fontWeight: 'bold', marginBottom: '4px' }}>
                💡 宅建は「過去問を回せば合格できる試験」
              </div>
              <div style={{ marginLeft: '8px' }}>
                このアプリはそのための準備です
              </div>
            </div>

            <div style={{
              backgroundColor: '#f5f5f5',
              border: '2px solid #9e9e9e',
              borderRadius: '8px',
              padding: '12px',
              fontSize: '12px',
              lineHeight: 1.6
            }}>
              <div style={{ fontWeight: 'bold', marginBottom: '8px', color: '#424242' }}>
                💡 このアプリでカバーしていない論点
              </div>
              
              <div style={{ marginBottom: '8px' }}>
                <strong>制限行為能力者</strong><br/>
                📊 出題頻度: 過去10年で4回（4問）<br/>
                💡 なぜ扱わないか: 出題頻度が低く、時間を頻出テーマに使う方が効率的
              </div>

              <div style={{ fontSize: '11px', color: '#666', marginTop: '8px' }}>
                その他、同時履行の抗弁権、危険負担なども低頻度のため省略しています。<br/>
                過去問で出てきたら教科書で確認してください。
              </div>
            </div>
          </div>
        </div>
      );

      const renderPrinciple = () => (
        <div style={{ padding: '16px' }}>
          <div style={{
            backgroundColor: 'white',
            borderRadius: '12px',
            padding: '16px',
            marginBottom: '16px',
            boxShadow: '0 2px 8px rgba(0,0,0,0.1)'
          }}>
            <div style={{
              fontSize: '16px',
              fontWeight: 'bold',
              color: '#2c3e50',
              marginBottom: '12px',
              borderBottom: '2px solid #9c27b0',
              paddingBottom: '8px'
            }}>
              📖 よく出る法律用語
            </div>
            
            <div style={{ fontSize: '13px', lineHeight: 1.8 }}>
              <div style={{ marginBottom: '12px', padding: '8px', backgroundColor: '#f5f5f5', borderRadius: '6px' }}>
                <strong style={{ color: '#1976d2' }}>対抗要件</strong> = 自分の権利を他人に主張するための条件<br/>
                <span style={{ fontSize: '11px', color: '#666', marginLeft: '8px' }}>
                  例：不動産なら「登記」、動産なら「引渡し」
                </span>
              </div>

              <div style={{ marginBottom: '12px', padding: '8px', backgroundColor: '#f5f5f5', borderRadius: '6px' }}>
                <strong style={{ color: '#1976d2' }}>対抗できる</strong> = 自分の権利を主張できる<br/>
                <span style={{ fontSize: '11px', color: '#666', marginLeft: '8px' }}>
                  例：「私が所有者だ」と主張できる
                </span>
              </div>

              <div style={{ marginBottom: '12px', padding: '8px', backgroundColor: '#f5f5f5', borderRadius: '6px' }}>
                <strong style={{ color: '#1976d2' }}>対抗できない</strong> = 自分の権利を主張できない<br/>
                <span style={{ fontSize: '11px', color: '#666', marginLeft: '8px' }}>
                  例：登記がないので負ける
                </span>
              </div>

              <div style={{ marginBottom: '12px', padding: '8px', backgroundColor: '#f5f5f5', borderRadius: '6px' }}>
                <strong style={{ color: '#1976d2' }}>第三者</strong> = 当事者以外の人（ただし正当な権利関係がある人）<br/>
                <span style={{ fontSize: '11px', color: '#666', marginLeft: '8px' }}>
                  例：二重譲渡の相手、差押債権者<br/>
                  注意：相続人、不法占拠者は「第三者」ではない
                </span>
              </div>

              <div style={{ marginBottom: '12px', padding: '8px', backgroundColor: '#f5f5f5', borderRadius: '6px' }}>
                <strong style={{ color: '#d32f2f' }}>二重譲渡</strong> = 同じ物を2人に売ること<br/>
                <span style={{ fontSize: '11px', color: '#666', marginLeft: '8px' }}>
                  例：AがBに売った後、同じ土地をCにも売る
                </span>
              </div>

              <div style={{ marginBottom: '12px', padding: '8px', backgroundColor: '#f5f5f5', borderRadius: '6px' }}>
                <strong style={{ color: '#d32f2f' }}>取得時効</strong> = 一定期間占有すると所有権を取得<br/>
                <span style={{ fontSize: '11px', color: '#666', marginLeft: '8px' }}>
                  例：20年間占有し続けると、自分のものになる
                </span>
              </div>

              <div style={{ 
                marginTop: '16px', 
                padding: '10px', 
                backgroundColor: '#fff3e0', 
                borderRadius: '6px',
                borderLeft: '4px solid #ff9800'
              }}>
                <div style={{ fontSize: '12px', fontWeight: 'bold', color: '#e65100', marginBottom: '6px' }}>
                  💡 応用編の用語
                </div>
                <div style={{ fontSize: '12px', lineHeight: 1.6, color: '#333' }}>
                  <strong style={{ color: '#d84315' }}>背信的悪意者</strong> = 知っててわざと邪魔した人<br/>
                  <span style={{ fontSize: '11px', color: '#666', marginLeft: '8px' }}>
                    例：Bの存在を知ってて、わざと先に登記して横取りした
                  </span><br/>
                  <span style={{ fontSize: '11px', color: '#d84315', marginLeft: '8px', fontWeight: 'bold' }}>
                    → こういう人は登記があっても保護されない（悪質すぎるから）
                  </span>
                </div>
              </div>
            </div>
          </div>

          <div style={{
            backgroundColor: 'white',
            borderRadius: '12px',
            padding: '16px',
            marginBottom: '16px',
            boxShadow: '0 2px 8px rgba(0,0,0,0.1)'
          }}>
            <div style={{
              fontSize: '16px',
              fontWeight: 'bold',
              color: '#e74c3c',
              marginBottom: '12px',
              borderBottom: '2px solid #e74c3c',
              paddingBottom: '8px'
            }}>
              原理① 不動産は登記が対抗要件
            </div>
            
            <div style={{ 
              backgroundColor: '#f5f5f5', 
              padding: '12px', 
              borderRadius: '8px', 
              marginBottom: '16px',
              fontSize: '13px',
              lineHeight: 1.8
            }}>
              <div style={{ marginBottom: '8px' }}>
                <strong>取引の流れ：</strong>
              </div>
              <div style={{
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                gap: '8px',
                marginBottom: '8px'
              }}>
                <PersonCircle label="A" role="売主" color="#e74c3c" />
                <div style={{ fontSize: '12px', color: '#666' }}>売却→</div>
                <div style={{
                  width: '30px',
                  height: '30px',
                  borderRadius: '50%',
                  backgroundColor: '#95a5a6',
                  color: 'white',
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  fontSize: '14px',
                  fontWeight: 'bold',
                  opacity: 0.6
                }}>B</div>
                <div style={{ fontSize: '12px', color: '#666' }}>登記せず</div>
              </div>
              <div style={{ fontSize: '12px', color: '#666', textAlign: 'center', marginBottom: '8px' }}>
                その後...
              </div>
              <div style={{
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                gap: '8px'
              }}>
                <PersonCircle label="A" role="売主" color="#e74c3c" />
                <div style={{ fontSize: '12px', color: '#666' }}>→また売却</div>
                <PersonCircle label="C" role="2人目" color="#27ae60" />
                <div style={{ fontSize: '12px', color: '#666' }}>→登記！</div>
              </div>
            </div>

            <div style={{ fontSize: '14px', lineHeight: 1.8, marginBottom: '12px', textAlign: 'center', fontWeight: 'bold' }}>
              どちらが土地を取得する？
            </div>

            <div style={{
              display: 'flex',
              justifyContent: 'space-around',
              alignItems: 'center',
              marginBottom: '16px'
            }}>
              <div style={{ textAlign: 'center' }}>
                <PersonCircle label="B" role="先に買った" color="#3498db" />
                <div style={{ fontSize: '11px', marginTop: '4px' }}>登記なし</div>
              </div>
              <div style={{ fontSize: '24px' }}>⚖️</div>
              <div style={{ textAlign: 'center' }}>
                <PersonCircle label="C" role="後から買った" color="#27ae60" />
                <div style={{ fontSize: '11px', marginTop: '4px' }}>登記あり</div>
              </div>
            </div>

            <div style={{ backgroundColor: '#e8f5e9', padding: '12px', borderRadius: '8px', fontSize: '13px', lineHeight: 1.8 }}>
              <strong style={{ color: '#2e7d32' }}>答え：Cの勝ち</strong><br/>
              <br/>
              理由：<br/>
              不動産の権利は「登記」で決まる（177条）<br/>
              契約の先後は関係ない<br/>
              登記の早い者勝ち
            </div>
          </div>

          <div style={{
            backgroundColor: 'white',
            borderRadius: '12px',
            padding: '16px',
            marginBottom: '16px',
            boxShadow: '0 2px 8px rgba(0,0,0,0.1)'
          }}>
            <div style={{
              fontSize: '16px',
              fontWeight: 'bold',
              color: '#3498db',
              marginBottom: '12px',
              borderBottom: '2px solid #3498db',
              paddingBottom: '8px'
            }}>
              原理② 善意悪意は関係ない
            </div>
            
            <div style={{ fontSize: '14px', lineHeight: 1.8, marginBottom: '12px' }}>
              対抗要件（177条）では、善意悪意を問わない
            </div>

            <div style={{ backgroundColor: '#fff3e0', padding: '12px', borderRadius: '8px', fontSize: '13px', lineHeight: 1.8, marginBottom: '12px' }}>
              <strong>例：</strong><br/>
              Cさん「Bさんが先に買ったの、知ってたよ」（悪意）<br/>
              でも、Cさんが先に登記 → Cの勝ち
            </div>

            <div style={{ backgroundColor: '#ffebee', padding: '12px', borderRadius: '8px', fontSize: '13px', lineHeight: 1.8 }}>
              <strong style={{ color: '#c62828' }}>例外：背信的悪意者</strong><br/>
              <br/>
              「知ってた」だけでなく、<br/>
              「わざと横取りした」場合<br/>
              → 登記があっても保護されない
            </div>
          </div>

          <div style={{
            backgroundColor: 'white',
            borderRadius: '12px',
            padding: '16px',
            marginBottom: '16px',
            boxShadow: '0 2px 8px rgba(0,0,0,0.1)'
          }}>
            <div style={{
              fontSize: '16px',
              fontWeight: 'bold',
              color: '#9c27b0',
              marginBottom: '12px',
              borderBottom: '2px solid #9c27b0',
              paddingBottom: '8px'
            }}>
              原理③ 「第三者」に注意
            </div>
            
            <div style={{ fontSize: '14px', lineHeight: 1.8, marginBottom: '12px' }}>
              177条の「第三者」= 正当な権利関係がある人
            </div>

            <div style={{ backgroundColor: '#e8f5e9', padding: '12px', borderRadius: '8px', fontSize: '13px', lineHeight: 1.8, marginBottom: '12px' }}>
              <strong style={{ color: '#2e7d32' }}>第三者に含まれる：</strong><br/>
              ・二重譲渡の相手<br/>
              ・差押債権者<br/>
              ・転得者（さらに買った人）
            </div>

            <div style={{ backgroundColor: '#ffebee', padding: '12px', borderRadius: '8px', fontSize: '13px', lineHeight: 1.8 }}>
              <strong style={{ color: '#c62828' }}>第三者に含まれない：</strong><br/>
              ・相続人（前の人の地位を引き継ぐだけ）<br/>
              ・不法占拠者（正当な権利がない）<br/>
              ・転得者（転々譲渡の後主）<br/>
              <br/>
              → これらには登記なしで対抗できる
            </div>

            <div style={{
              backgroundColor: '#e3f2fd',
              padding: '12px',
              borderRadius: '8px',
              fontSize: '13px',
              lineHeight: 1.8,
              marginTop: '12px',
              border: '2px solid #2196f3'
            }}>
              <strong style={{ color: '#1565c0' }}>💡 転得者（転々譲渡）の特殊性</strong><br/>
              <br/>
              <strong>例：A → B → C と転々譲渡</strong><br/>
              <br/>
              BとCの関係：<br/>
              ・BとCは「当事者」（売買契約）<br/>
              ・登記は不要<br/>
              <br/>
              <strong style={{ color: '#d32f2f' }}>AとCの関係：</strong><br/>
              ・Cは「第三者」ではない<br/>
              ・CはAに対して登記なしで対抗できる<br/>
              <br/>
              <strong>理由：</strong><br/>
              転々譲渡では、前主(A)と後主(C)は<br/>
              「当事者と類似の関係」にあるため
            </div>
          </div>

          <div style={{
            backgroundColor: 'white',
            borderRadius: '12px',
            padding: '16px',
            marginBottom: '16px',
            boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
            border: '2px solid #e3f2fd'
          }}>
            <div style={{
              fontSize: '15px',
              fontWeight: 'bold',
              color: '#1976d2',
              marginBottom: '12px',
              paddingBottom: '8px',
              borderBottom: '2px solid #e3f2fd'
            }}>
              💡 この分野の他の論点
            </div>
            
            <div style={{ fontSize: '13px', lineHeight: 1.8, marginBottom: '12px' }}>
              このアプリでカバーしているのは、<br/>
              物権変動「<strong>対抗要件</strong>」の<strong>頻出3パターン</strong>です。
            </div>

            <div style={{
              backgroundColor: '#f5f5f5',
              padding: '12px',
              borderRadius: '8px',
              marginBottom: '12px',
              fontSize: '13px',
              lineHeight: 1.8
            }}>
              <div style={{ fontWeight: 'bold', marginBottom: '6px', color: '#666' }}>
                以下のような論点は扱っていません：
              </div>
              <div style={{ marginLeft: '8px', color: '#666' }}>
                ・動産の対抗要件（引渡し）<br/>
                ・明認方法<br/>
                ・即時取得（192条）<br/>
                ・占有改定
              </div>
            </div>

            <div style={{
              backgroundColor: '#e8f5e9',
              padding: '12px',
              borderRadius: '8px',
              fontSize: '13px',
              lineHeight: 1.8
            }}>
              <div style={{ fontWeight: 'bold', color: '#2e7d32', marginBottom: '4px' }}>
                💡 でも大丈夫！
              </div>
              <div style={{ color: '#2e7d32' }}>
                このアプリの内容で、この分野の過去問<strong>約80%</strong>はカバーできます。<br/>
                残りは教科書や過去問で確認してください。
              </div>
            </div>
          </div>
        </div>
      );

      const renderTable = () => (
        <div style={{ padding: '16px' }}>
          <div style={{
            backgroundColor: '#e8f5e9',
            padding: '12px',
            borderRadius: '8px',
            marginBottom: '16px',
            fontSize: '12px'
          }}>
            <strong>見方：</strong> 登記がないとどうなるか
          </div>

          <div style={{
            backgroundColor: 'white',
            borderRadius: '12px',
            overflow: 'hidden',
            boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
            marginBottom: '16px'
          }}>
            <div style={{
              backgroundColor: '#2c3e50',
              color: 'white',
              padding: '12px',
              textAlign: 'center',
              fontWeight: 'bold'
            }}>
              登記の有無と対抗
            </div>

            <div style={{
              display: 'grid',
              gridTemplateColumns: '1.2fr 1fr 1fr',
              backgroundColor: '#ecf0f1',
              fontSize: '11px',
              fontWeight: 'bold'
            }}>
              <div style={{ padding: '8px', borderRight: '1px solid #bdc3c7' }}>状況</div>
              <div style={{ padding: '8px', textAlign: 'center', borderRight: '1px solid #bdc3c7' }}>登記</div>
              <div style={{ padding: '8px', textAlign: 'center' }}>結果</div>
            </div>

            <div style={{
              display: 'grid',
              gridTemplateColumns: '1.2fr 1fr 1fr',
              borderBottom: '1px solid #ecf0f1',
              fontSize: '12px'
            }}>
              <div style={{ padding: '10px 8px', borderRight: '1px solid #ecf0f1', backgroundColor: '#e3f2fd' }}>
                <strong>二重譲渡</strong><br/>
                <span style={{ fontSize: '10px', color: '#1565c0' }}>先に買ったB、後から買ったC</span>
              </div>
              <div style={{ padding: '10px 8px', textAlign: 'center', borderRight: '1px solid #ecf0f1' }}>
                <strong style={{ color: '#27ae60' }}>Cが先に</strong><br/>
                <span style={{ fontSize: '10px' }}>登記</span>
              </div>
              <div style={{ padding: '10px 8px', textAlign: 'center' }}>
                <strong style={{ color: '#27ae60' }}>Cの勝ち</strong><br/>
                <span style={{ fontSize: '10px' }}>登記の早い者勝ち</span>
              </div>
            </div>

            <div style={{
              display: 'grid',
              gridTemplateColumns: '1.2fr 1fr 1fr',
              borderBottom: '1px solid #ecf0f1',
              fontSize: '12px'
            }}>
              <div style={{ padding: '10px 8px', borderRight: '1px solid #ecf0f1', backgroundColor: '#fff8e1' }}>
                <strong>時効完成前</strong><br/>
                <span style={{ fontSize: '10px', color: '#e65100' }}>Aが占有中、BがCに売却</span>
              </div>
              <div style={{ padding: '10px 8px', textAlign: 'center', borderRight: '1px solid #ecf0f1' }}>
                <strong style={{ color: '#27ae60' }}>Aは登記なし</strong>
              </div>
              <div style={{ padding: '10px 8px', textAlign: 'center' }}>
                <strong style={{ color: '#27ae60' }}>Aの勝ち</strong><br/>
                <span style={{ fontSize: '10px' }}>当事者なので登記不要</span>
              </div>
            </div>

            <div style={{
              display: 'grid',
              gridTemplateColumns: '1.2fr 1fr 1fr',
              fontSize: '12px'
            }}>
              <div style={{ padding: '10px 8px', borderRight: '1px solid #ecf0f1', backgroundColor: '#f3e5f5' }}>
                <strong>時効完成後</strong><br/>
                <span style={{ fontSize: '10px', color: '#7b1fa2' }}>Aが時効取得、BがCに売却</span>
              </div>
              <div style={{ padding: '10px 8px', textAlign: 'center', borderRight: '1px solid #ecf0f1' }}>
                <strong style={{ color: '#e74c3c' }}>Aは登記なし</strong>
              </div>
              <div style={{ padding: '10px 8px', textAlign: 'center' }}>
                <strong style={{ color: '#e74c3c' }}>Aの負け</strong><br/>
                <span style={{ fontSize: '10px' }}>完成後は登記が必要</span>
              </div>
            </div>
          </div>

          <div style={{
            backgroundColor: 'white',
            borderRadius: '12px',
            overflow: 'hidden',
            boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
            marginBottom: '16px'
          }}>
            <div style={{
              backgroundColor: '#7b1fa2',
              color: 'white',
              padding: '12px',
              textAlign: 'center',
              fontWeight: 'bold'
            }}>
              第三者の範囲
            </div>

            <div style={{
              display: 'grid',
              gridTemplateColumns: '1fr 1fr',
              backgroundColor: '#ecf0f1',
              fontSize: '11px',
              fontWeight: 'bold'
            }}>
              <div style={{ padding: '8px', borderRight: '1px solid #bdc3c7' }}>相手</div>
              <div style={{ padding: '8px', textAlign: 'center' }}>登記の必要性</div>
            </div>

            <div style={{
              display: 'grid',
              gridTemplateColumns: '1fr 1fr',
              borderBottom: '1px solid #ecf0f1',
              fontSize: '12px'
            }}>
              <div style={{ padding: '10px 8px', borderRight: '1px solid #ecf0f1' }}>
                <strong style={{ color: '#27ae60' }}>二重譲渡の相手</strong>
              </div>
              <div style={{ padding: '10px 8px', textAlign: 'center' }}>
                <strong style={{ color: '#e74c3c' }}>必要</strong>
              </div>
            </div>

            <div style={{
              display: 'grid',
              gridTemplateColumns: '1fr 1fr',
              borderBottom: '1px solid #ecf0f1',
              fontSize: '12px'
            }}>
              <div style={{ padding: '10px 8px', borderRight: '1px solid #ecf0f1' }}>
                <strong style={{ color: '#27ae60' }}>差押債権者</strong>
              </div>
              <div style={{ padding: '10px 8px', textAlign: 'center' }}>
                <strong style={{ color: '#e74c3c' }}>必要</strong>
              </div>
            </div>

            <div style={{
              display: 'grid',
              gridTemplateColumns: '1fr 1fr',
              borderBottom: '1px solid #ecf0f1',
              fontSize: '12px'
            }}>
              <div style={{ padding: '10px 8px', borderRight: '1px solid #ecf0f1' }}>
                <strong style={{ color: '#e74c3c' }}>相続人</strong>
              </div>
              <div style={{ padding: '10px 8px', textAlign: 'center' }}>
                <strong style={{ color: '#27ae60' }}>不要</strong><br/>
                <span style={{ fontSize: '10px' }}>第三者ではない</span>
              </div>
            </div>

            <div style={{
              display: 'grid',
              gridTemplateColumns: '1fr 1fr',
              fontSize: '12px'
            }}>
              <div style={{ padding: '10px 8px', borderRight: '1px solid #ecf0f1' }}>
                <strong style={{ color: '#e74c3c' }}>不法占拠者</strong>
              </div>
              <div style={{ padding: '10px 8px', textAlign: 'center' }}>
                <strong style={{ color: '#27ae60' }}>不要</strong><br/>
                <span style={{ fontSize: '10px' }}>第三者ではない</span>
              </div>
            </div>

            <div style={{
              display: 'grid',
              gridTemplateColumns: '1fr 1fr',
              fontSize: '12px',
              backgroundColor: '#f0f9ff'
            }}>
              <div style={{ padding: '10px 8px', borderRight: '1px solid #ecf0f1' }}>
                <strong style={{ color: '#1976d2' }}>転得者（A→B→C）</strong><br/>
                <span style={{ fontSize: '10px' }}>AとCの関係</span>
              </div>
              <div style={{ padding: '10px 8px', textAlign: 'center' }}>
                <strong style={{ color: '#27ae60' }}>不要</strong><br/>
                <span style={{ fontSize: '10px' }}>前主と後主は当事者関係</span>
              </div>
            </div>
          </div>

          <div style={{
            backgroundColor: 'white',
            borderRadius: '12px',
            overflow: 'hidden',
            boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
            marginBottom: '16px'
          }}>
            <div style={{
              backgroundColor: '#c62828',
              color: 'white',
              padding: '12px',
              textAlign: 'center',
              fontWeight: 'bold'
            }}>
              特殊なケース
            </div>

            <div style={{ padding: '16px', fontSize: '13px', lineHeight: 1.8 }}>
              <div style={{ marginBottom: '12px' }}>
                <strong style={{ color: '#c62828' }}>背信的悪意者</strong><br/>
                「Bの存在を知ってて、わざと先に登記して横取り」<br/>
                → <strong>登記があっても保護されない</strong>
              </div>

              <div style={{ backgroundColor: '#ffebee', padding: '8px', borderRadius: '6px', fontSize: '12px' }}>
                通常の悪意者：登記があれば勝つ<br/>
                背信的悪意者：登記があっても負ける
              </div>
            </div>
          </div>

          <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
            <a href="https://elaws.e-gov.go.jp/document?lawid=129AC0000000089#Mp-At_177" target="_blank" rel="noopener noreferrer"
              style={{ display: 'block', backgroundColor: '#34495e', color: 'white', padding: '12px', borderRadius: '8px', textAlign: 'center', textDecoration: 'none', fontSize: '13px' }}>
              📖 177条（不動産登記の対抗力）
            </a>
          </div>
        </div>
      );

      const renderQuiz = () => {
        if (!quizStarted) {
          const level1Unmastered = quizzesLevel1.filter((_, idx) => !masteredQuestions.has(`1-${idx}`)).length;
          const level2Unmastered = quizzesLevel2.filter((_, idx) => !masteredQuestions.has(`2-${idx}`)).length;
          
          return (
            <div style={{ padding: '16px', textAlign: 'center' }}>
              <div style={{
                backgroundColor: 'white',
                borderRadius: '12px',
                padding: '24px',
                boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                marginBottom: '16px'
              }}>
                <div style={{ fontSize: '48px', marginBottom: '16px' }}>🎯</div>
                <div style={{ fontSize: '18px', fontWeight: 'bold', marginBottom: '16px' }}>千本ノック！</div>
                
                <div style={{ fontSize: '14px', color: '#7f8c8d', marginBottom: '24px' }}>
                  レベルを選んでください
                </div>

                <div style={{ marginBottom: '24px' }}>
                  <button
                    onClick={() => startQuiz(1, 'all')}
                    style={{
                      width: '100%',
                      backgroundColor: '#3498db',
                      color: 'white',
                      border: 'none',
                      borderRadius: '8px',
                      padding: '16px',
                      fontSize: '14px',
                      fontWeight: 'bold',
                      cursor: 'pointer',
                      marginBottom: '8px'
                    }}
                  >
                    <div>レベル1：基礎（全問題）</div>
                    <div style={{ fontSize: '12px', fontWeight: 'normal', marginTop: '4px' }}>
                      分かりやすい文章で原理を確認（{quizzesLevel1.length}問）
                    </div>
                  </button>
                  
                  {level1Unmastered > 0 && (
                    <button
                      onClick={() => startQuiz(1, 'unmastered')}
                      style={{
                        width: '100%',
                        backgroundColor: '#9b59b6',
                        color: 'white',
                        border: 'none',
                        borderRadius: '8px',
                        padding: '12px',
                        fontSize: '13px',
                        fontWeight: 'bold',
                        cursor: 'pointer',
                        marginBottom: '12px'
                      }}
                    >
                      レベル1：未習得のみ（{level1Unmastered}問）
                    </button>
                  )}
                </div>

                <div>
                  <button
                    onClick={() => startQuiz(2, 'all')}
                    style={{
                      width: '100%',
                      backgroundColor: '#e74c3c',
                      color: 'white',
                      border: 'none',
                      borderRadius: '8px',
                      padding: '16px',
                      fontSize: '14px',
                      fontWeight: 'bold',
                      cursor: 'pointer',
                      marginBottom: '8px'
                    }}
                  >
                    <div>レベル2：実戦（全問題）</div>
                    <div style={{ fontSize: '12px', fontWeight: 'normal', marginTop: '4px' }}>
                      本試験レベルのややこしい文章（{quizzesLevel2.length}問）
                    </div>
                  </button>
                  
                  {level2Unmastered > 0 && (
                    <button
                      onClick={() => startQuiz(2, 'unmastered')}
                      style={{
                        width: '100%',
                        backgroundColor: '#9b59b6',
                        color: 'white',
                        border: 'none',
                        borderRadius: '8px',
                        padding: '12px',
                        fontSize: '13px',
                        fontWeight: 'bold',
                        cursor: 'pointer'
                      }}
                    >
                      レベル2：未習得のみ（{level2Unmastered}問）
                    </button>
                  )}
                </div>
              </div>
            </div>
          );
        }

        if (quizFinished) {
          const percentage = Math.round((score / shuffledQuizzes.length) * 100);
          let message = '';
          let emoji = '';
          if (percentage === 100) {
            message = '完璧！素晴らしい！';
            emoji = '🎉';
          } else if (percentage >= 80) {
            message = 'よくできました！';
            emoji = '😊';
          } else if (percentage >= 60) {
            message = 'もう少し！復習しよう';
            emoji = '💪';
          } else {
            message = '原理と表を確認してから再挑戦！';
            emoji = '📚';
          }

          return (
            <div style={{ padding: '16px', textAlign: 'center' }}>
              <div style={{
                backgroundColor: 'white',
                borderRadius: '12px',
                padding: '24px',
                boxShadow: '0 2px 8px rgba(0,0,0,0.1)'
              }}>
                <div style={{ fontSize: '48px', marginBottom: '16px' }}>{emoji}</div>
                <div style={{ 
                  fontSize: '14px', 
                  color: level === 1 ? '#3498db' : '#e74c3c',
                  marginBottom: '8px'
                }}>
                  レベル{level}：{level === 1 ? '基礎' : '実戦'}
                  {reviewMode === 'unmastered' && '（未習得のみ）'}
                </div>
                <div style={{ fontSize: '24px', fontWeight: 'bold', marginBottom: '8px' }}>
                  {score} / {shuffledQuizzes.length} 正解
                </div>
                <div style={{ fontSize: '18px', color: '#7f8c8d', marginBottom: '8px' }}>
                  正答率 {percentage}%
                </div>
                <div style={{ fontSize: '16px', marginBottom: '24px' }}>
                  {message}
                </div>
                <button
                  onClick={() => startQuiz(level, reviewMode)}
                  style={{
                    width: '100%',
                    backgroundColor: '#3498db',
                    color: 'white',
                    border: 'none',
                    borderRadius: '8px',
                    padding: '16px',
                    fontSize: '16px',
                    fontWeight: 'bold',
                    cursor: 'pointer',
                    marginBottom: '12px'
                  }}
                >
                  同じ設定で再挑戦
                </button>
                <button
                  onClick={resetQuiz}
                  style={{
                    width: '100%',
                    backgroundColor: '#ecf0f1',
                    color: '#2c3e50',
                    border: 'none',
                    borderRadius: '8px',
                    padding: '16px',
                    fontSize: '16px',
                    fontWeight: 'bold',
                    cursor: 'pointer'
                  }}
                >
                  レベル選択に戻る
                </button>
              </div>
            </div>
          );
        }

        const quiz = shuffledQuizzes[currentQuiz];
        const isCorrect = selectedAnswer === quiz.answer;

        return (
          <div style={{ padding: '16px' }}>
            <div style={{
              display: 'flex',
              justifyContent: 'space-between',
              alignItems: 'center',
              marginBottom: '12px'
            }}>
              <div style={{ fontSize: '14px', color: '#7f8c8d' }}>
                <span style={{ 
                  color: level === 1 ? '#3498db' : '#e74c3c',
                  fontWeight: 'bold'
                }}>
                  Lv.{level}
                </span>
                {' '}問題 {currentQuiz + 1} / {shuffledQuizzes.length}
              </div>
              <div style={{
                backgroundColor: '#27ae60',
                color: 'white',
                padding: '4px 12px',
                borderRadius: '12px',
                fontSize: '11px'
              }}>
                {quiz.category}
              </div>
            </div>

            <div style={{
              backgroundColor: '#ecf0f1',
              borderRadius: '4px',
              height: '8px',
              marginBottom: '16px'
            }}>
              <div style={{
                backgroundColor: level === 1 ? '#3498db' : '#e74c3c',
                borderRadius: '4px',
                height: '8px',
                width: `${((currentQuiz + 1) / shuffledQuizzes.length) * 100}%`,
                transition: 'width 0.3s'
              }}></div>
            </div>

            <div style={{
              backgroundColor: 'white',
              borderRadius: '12px',
              padding: '16px',
              marginBottom: '16px',
              boxShadow: '0 2px 8px rgba(0,0,0,0.1)'
            }}>
              <div style={{ fontSize: '14px', lineHeight: 1.8 }}>
                {quiz.question}
              </div>
            </div>

            <div style={{ display: 'flex', gap: '12px', marginBottom: '16px' }}>
              <button
                onClick={() => handleAnswer(true)}
                disabled={answered}
                style={{
                  flex: 1,
                  padding: '16px',
                  fontSize: '18px',
                  fontWeight: 'bold',
                  border: 'none',
                  borderRadius: '12px',
                  cursor: answered ? 'default' : 'pointer',
                  backgroundColor: answered
                    ? (quiz.answer === true ? '#27ae60' : (selectedAnswer === true ? '#e74c3c' : '#ecf0f1'))
                    : '#e3f2fd',
                  color: answered
                    ? (quiz.answer === true || selectedAnswer === true ? 'white' : '#2c3e50')
                    : '#2c3e50'
                }}
              >
                ⭕ 正しい
              </button>
              <button
                onClick={() => handleAnswer(false)}
                disabled={answered}
                style={{
                  flex: 1,
                  padding: '16px',
                  fontSize: '18px',
                  fontWeight: 'bold',
                  border: 'none',
                  borderRadius: '12px',
                  cursor: answered ? 'default' : 'pointer',
                  backgroundColor: answered
                    ? (quiz.answer === false ? '#27ae60' : (selectedAnswer === false ? '#e74c3c' : '#ecf0f1'))
                    : '#fce4ec',
                  color: answered
                    ? (quiz.answer === false || selectedAnswer === false ? 'white' : '#2c3e50')
                    : '#2c3e50'
                }}
              >
                ❌ 誤り
              </button>
            </div>

            {answered && (
              <div style={{
                backgroundColor: isCorrect ? '#e8f5e9' : '#ffebee',
                borderRadius: '12px',
                padding: '16px',
                marginBottom: '16px'
              }}>
                <div style={{
                  fontSize: '18px',
                  fontWeight: 'bold',
                  marginBottom: '8px',
                  color: isCorrect ? '#27ae60' : '#e74c3c'
                }}>
                  {isCorrect ? '⭕ 正解！' : '❌ 不正解'}
                </div>
                <div style={{ fontSize: '14px', lineHeight: 1.8 }}>
                  {quiz.explanation}
                </div>
              </div>
            )}

            {answered && (
              <div style={{ display: 'flex', gap: '8px', marginBottom: '16px' }}>
                {isCorrect && (
                  <button
                    onClick={markAsMastered}
                    style={{
                      flex: 1,
                      padding: '14px',
                      fontSize: '14px',
                      fontWeight: 'bold',
                      border: '2px solid #9b59b6',
                      borderRadius: '12px',
                      backgroundColor: 'white',
                      color: '#9b59b6',
                      cursor: 'pointer'
                    }}
                  >
                    ✅ 完璧！次回から出さない
                  </button>
                )}
              </div>
            )}

            <div style={{ display: 'flex', gap: '8px', marginBottom: '8px' }}>
              <button
                onClick={prevQuiz}
                disabled={currentQuiz === 0}
                style={{
                  flex: 1,
                  padding: '14px',
                  fontSize: '14px',
                  fontWeight: 'bold',
                  border: 'none',
                  borderRadius: '12px',
                  backgroundColor: currentQuiz === 0 ? '#ecf0f1' : '#95a5a6',
                  color: 'white',
                  cursor: currentQuiz === 0 ? 'default' : 'pointer'
                }}
              >
                ← 前の問題
              </button>
              
              {answered && (
                <button
                  onClick={nextQuiz}
                  style={{
                    flex: 1,
                    padding: '14px',
                    fontSize: '14px',
                    fontWeight: 'bold',
                    border: 'none',
                    borderRadius: '12px',
                    backgroundColor: level === 1 ? '#3498db' : '#e74c3c',
                    color: 'white',
                    cursor: 'pointer'
                  }}
                >
                  {currentQuiz + 1 >= shuffledQuizzes.length ? '結果を見る' : '次の問題 →'}
                </button>
              )}
            </div>
            
            <button
              onClick={resetQuiz}
              style={{
                width: '100%',
                padding: '12px',
                fontSize: '13px',
                fontWeight: 'bold',
                border: '2px solid #95a5a6',
                borderRadius: '12px',
                backgroundColor: 'white',
                color: '#95a5a6',
                cursor: 'pointer'
              }}
            >
              クイズを終了してレベル選択に戻る
            </button>
          </div>
        );
      };

      return (
        <div style={{
          maxWidth: '400px',
          margin: '0 auto',
          backgroundColor: '#f8f9fa',
          minHeight: '100vh'
        }}>
          <div style={{
            backgroundColor: '#2c3e50',
            color: 'white',
            padding: '16px',
            textAlign: 'center'
          }}>
            <div style={{ fontSize: '11px', opacity: 0.8 }}>宅建学習アプリ</div>
            <div style={{ fontSize: '16px', fontWeight: 'bold', marginTop: '2px' }}>権利関係（民法）＞ 物権変動 ＞ 対抗要件</div>
            <div style={{ fontSize: '12px', marginTop: '4px', opacity: 0.9 }}>登記の対抗力（177条）</div>
          </div>

          <div style={{ display: 'flex', backgroundColor: '#ecf0f1' }}>
            <button
              onClick={() => setPage('about')}
              style={{
                flex: 1,
                padding: '12px',
                border: 'none',
                backgroundColor: page === 'about' ? '#9b59b6' : '#ecf0f1',
                color: page === 'about' ? 'white' : '#2c3e50',
                fontWeight: 'bold',
                fontSize: '13px',
                cursor: 'pointer'
              }}
            >
              ℹ️ 説明
            </button>
            <button
              onClick={() => setPage('principle')}
              style={{
                flex: 1,
                padding: '12px',
                border: 'none',
                backgroundColor: page === 'principle' ? '#3498db' : '#ecf0f1',
                color: page === 'principle' ? 'white' : '#2c3e50',
                fontWeight: 'bold',
                fontSize: '13px',
                cursor: 'pointer'
              }}
            >
              原理を理解
            </button>
            <button
              onClick={() => setPage('table')}
              style={{
                flex: 1,
                padding: '12px',
                border: 'none',
                backgroundColor: page === 'table' ? '#3498db' : '#ecf0f1',
                color: page === 'table' ? 'white' : '#2c3e50',
                fontWeight: 'bold',
                fontSize: '13px',
                cursor: 'pointer'
              }}
            >
              表で暗記
            </button>
            <button
              onClick={() => setPage('quiz')}
              style={{
                flex: 1,
                padding: '12px',
                border: 'none',
                backgroundColor: page === 'quiz' ? '#27ae60' : '#ecf0f1',
                color: page === 'quiz' ? 'white' : '#2c3e50',
                fontWeight: 'bold',
                fontSize: '13px',
                cursor: 'pointer'
              }}
            >
              🎯 クイズ
            </button>
          </div>

          {page === 'about' && renderAbout()}
          {page === 'principle' && renderPrinciple()}
          {page === 'table' && renderTable()}
          {page === 'quiz' && renderQuiz()}
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<QuizApp />);
  </script>
</body>
</html>
